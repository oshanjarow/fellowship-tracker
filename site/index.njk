---
layout: base.njk
title: Fellowship & Grant Tracker
---

<header class="header">
  <h1>Fellowship & Grant Tracker</h1>
  <p class="subtitle">Opportunities for narrative journalism and nonfiction writers</p>
</header>

<div class="filters">
  <label>
    <span>Filter by type:</span>
    <select id="type-filter">
      <option value="all">All types</option>
      <option value="fellowship">Fellowships</option>
      <option value="grant">Grants</option>
      <option value="award">Awards</option>
      <option value="funding">Funding</option>
    </select>
  </label>
  <label>
    <input type="checkbox" id="hide-no-deadline">
    Hide items without deadlines
  </label>
</div>

<div class="stats">
  <span><strong>{{ opportunities.length }}</strong> opportunities</span>
  <span class="divider">|</span>
  <span>Updated: {{ "now" | formatDate }}</span>
</div>

<main class="opportunities">
  {% for opp in opportunities %}
  <article class="card{% if opp.deadline | isClosingSoon %} closing-soon{% endif %}{% if opp.deadline | isExpired %} expired{% endif %}" data-type="{{ opp.type | lower }}">
    {% if opp.deadline | isClosingSoon %}
    <span class="badge urgent">Closing Soon</span>
    {% endif %}

    <h2 class="card-title">
      <a href="{{ opp.url }}" target="_blank" rel="noopener">{{ opp.title }}</a>
    </h2>

    <div class="card-details">
      {% if opp.funding_size %}
      <span class="detail">
        <span class="amount">{{ opp.funding_size }}</span>
      </span>
      {% endif %}

      {% if opp.deadline %}
      <span class="detail">
        <span class="deadline{% if opp.deadline | isClosingSoon %} urgent{% endif %}">{{ opp.deadline }}</span>
      </span>
      {% endif %}

      {% if opp.region %}
      <span class="detail">
        <span class="region">{{ opp.region }}</span>
      </span>
      {% endif %}
    </div>

    <div class="card-meta">
      <span class="source">{{ opp.source }}</span>
      <span class="type">{{ opp.type }}</span>
      {% if opp.organisation %}
      <span class="org">{{ opp.organisation }}</span>
      {% endif %}
    </div>

    {% if opp.description and opp.description.length > 10 %}
    <p class="card-description">{{ opp.description | truncate(200) }}</p>
    {% endif %}

    <a href="{{ opp.url }}" class="card-link" target="_blank" rel="noopener">
      View opportunity &rarr;
    </a>
  </article>
  {% else %}
  <p class="empty-state">No opportunities found. Check back soon!</p>
  {% endfor %}
</main>

<footer class="footer">
  <p>Data is scraped automatically from multiple sources. Always verify details on the original website.</p>
  <p>Sources: GIJN, GFMD, and various journalism fellowship programs.</p>
</footer>

<script>
  // Filter functionality
  const typeFilter = document.getElementById('type-filter');
  const hideNoDeadline = document.getElementById('hide-no-deadline');
  const cards = document.querySelectorAll('.card');

  function applyFilters() {
    const selectedType = typeFilter.value;
    const hideEmpty = hideNoDeadline.checked;

    cards.forEach(card => {
      const cardType = card.dataset.type || '';
      const hasDeadline = card.querySelector('.deadline') !== null;

      let show = true;

      if (selectedType !== 'all' && !cardType.includes(selectedType)) {
        show = false;
      }

      if (hideEmpty && !hasDeadline) {
        show = false;
      }

      card.style.display = show ? 'block' : 'none';
    });
  }

  typeFilter.addEventListener('change', applyFilters);
  hideNoDeadline.addEventListener('change', applyFilters);
</script>
